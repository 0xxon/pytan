# TODO currently, cElementTree is showing the fastest times. more testing needed
XML_ENGINE = "cet"
"""str of XML engine to use for XML de/serialization, must be one of XML_ENGINES"""
XML_ENGINES = {
    "cet": "xml.etree.cElementTree",
    "lxml": "lxml.etree",
    "et": "xml.etree.ElementTree",
}
"""
dict of valid XML_ENGINE values to use for XML de/serialization
also the order of priority to try for fallback if XML_ENGINE fails to import or is not set
"""
TAG_NAME = '_tickled_tag'
"""str of attribute to hold _SOAP_TAG of tanium_ng object so tickle can deserialize"""
LIST_NAME = '_tickled_list'
"""str of attribute to hold list of serialized tanium_ng objs"""
EXPLODE_NAME = '_tickled_explode'
"""str of attribute to identify JSON exploded property value in seriailzed dicts"""
INCLUDE_EMPTY = False
"""bool that controls if empty attributes will be included in serialized outputs"""
JSON_SORT_KEYS = True
"""bool that controls if the JSON string will be written with its keys sorted"""
JSON_INDENT = 2
"""int that controls how many spaces will be used to pretty print the JSON, None to disable"""
FLAT_WARN = {'_TICKLE_WARN': "Flattened objects can not be deserialized back later!!"}
"""dict to update serialized flat dicts with if FLAT=True"""
FLAT_SEP = '_'
"""str to seperate the tree of property names in serialized flat dicts with if FLAT=True"""

SSE_WRAP = (
    '''<result_sets><result_set>
{SSE_DATA}
</result_set></result_sets>
''')
"""str of XML to wrap XML received from a server side data export with"""
TANIUM_TIME_FORMAT = '%Y-%m-%dT%H:%M:%S'
"""str of Tanium's format for date time strings"""

FIRSTS = ['id', 'name', 'description']
LASTS = []
SKIPS = [TAG_NAME, LIST_NAME, EXPLODE_NAME]
SKIPS += list(FLAT_WARN.keys())
HUMAN_TIME_FORMAT = 'D%Y-%m-%dT%H-%M-%S-%f'

RESULTSET_ARGS = {
    'add_type': True,
    'add_sensor': True,
    'flatten': False,
    'yaxis': False,
}

PARAMETER_DEFAULTS = {
    'sensor_delimiter': '||',
    'action_delimiter': '',
    'auto_default': True,
    'extras_allowed': True,
    'missing_prompt': True,  # TODO!!!
}
FILTER_DEFAULTS = {
    'not_flag': None,
    'ignore_case_flag': None,
    'operator': 'RegexMatch',
    'value_type': 'String',
    'max_age_seconds': None,
    'all_values_flag': None,
    'value': None,
}
QUESTION_DEFAULTS = {
    'expire_seconds': None,
    'skip_lock_flag': None,
}
GROUP_DEFAULTS = {
    'and_flag': None,
    'not_flag': None,
}

RESULTSET_STRS = {
    'row_column_name': '{c.display_name}',
    'sensor_type': 'Result Type: {c.result_type}',
    'sensor': 'From Sensor: {c.sensor_nameorhash}',
    'flat_idx_fail': "NO INDEX CORRELATED VALUE FOR {c.display_name} INDEX: {idx}",
    'flat_row_unrelated': "UNRELATED TO SENSOR: {s}",
    'flow_row_unexpected': "UNEXPECTED SCENARIO WITH SENSOR: {s}",
    'yaxis_row_vals': 'Values in row: {ri}',
    'yaxis_flat_vals': 'Value {idx:03d}',
    'finished': "Created {resultlen} rows from {rowlen} rows and {collen} columns "
    "using flatten={flatten}, yaxis={yaxis}, add_type={add_type}, add_sensor={add_sensor} "
    "from tanium_ng object:: {obj}",
}

FALLBACK_HASH_MAP = {
    7318847: 'Last Logged In User',
    8168018: 'Video Driver Version',
    15451865: 'USB Device',
    21983240: 'AD Organizational Unit',
    45421433: 'Operating System',
    63201224: 'File Size',
    74624344: 'Windows OS Type',
    75018363: 'User Sessions',
    77425467: 'SQL Log Sizes',
    93198492: 'Open Share Details',
    95001259: 'Tanium File Exists',
    98057726: 'Boot Time',
    99939055: 'Wireless Network SSID Strength',
    102224229: 'Computer Serial Number',
    112406691: 'File Version',
    131549066: 'Online',
    151176619: 'Onboard Devices',
    170942492: 'System Drive',
    182214159: 'Local User Login Dates',
    189860887: 'Audio Controller',
    191451006: 'Tanium Buffer Count',
    254407409: 'Installed HotFixes',
    276664624: 'Maximum Process Memory Size',
    283520893: 'Tanium Client Dump Files',
    314220795: 'USB Device Details',
    316030016: 'Total Memory',
    319662655: 'Running Processes Memory Usage',
    322086833: 'Download Statuses',
    324032765: 'UDP Connections',
    333178608: 'Tanium Zone Server Version',
    341438855: 'Recently Run Applications',
    367063513: 'BIOS Name',
    391368340: 'SQL Server Agent Long Running Jobs',
    422662332: 'Static IP Addresses',
    432766313: 'SQL Buffer Hit Ratio',
    435227963: 'IP Route Details',
    435957060: 'Tanium Client Version',
    462732724: 'AD Domain',
    482346946: 'SQL Product Level',
    487354270: 'IP Routes',
    502812713: 'Application Event Log IDs',
    508127351: 'Disk Used Space',
    525163843: 'AD Computer Groups',
    533135859: 'Disk Used Percentage',
    542266296: 'Share Folder Permissions',
    549503533: 'Operating System Language',
    568581921: 'Reboot Required',
    590837956: 'Number of Fixed Drives',
    600562575: 'CPU by Process',
    601571508: 'Open Port',
    607666494: 'Application Crashes Yesterday',
    617084407: 'Logical Volumes',
    632662206: 'Folder Size',
    664237249: 'Application Run Time',
    676468157: 'Installed RPMs',
    711837192: 'Tanium Server Version',
    740857544: 'Target',
    745447734: 'Cached AD Logins',
    747106243: 'System Slots In Use',
    749653644: 'SQL Server Edition',
    782305667: 'RAM Max Capacity',
    794103688: 'Domain Name',
    801419063: 'Defrag Needed',
    801908140: 'User Details',
    824239263: 'Tanium Client Core Health',
    833799742: 'BIOS Version',
    856087598: 'PST Information',
    861367460: 'Shared Network Printer Details',
    865123401: 'Kernel Modules',
    867160258: 'Hyperthreading Enabled',
    876725971: 'Network Printer Details',
    885259283: 'Motherboard Manufacturer',
    889071797: 'Firewall Status',
    902205018: 'Country Code',
    916410332: 'Data Execution Prevention Enabled',
    923740265: 'CD-ROM Drive',
    926119908: 'Service',
    945314213: 'Disk Drives',
    953427826: 'Video/Graphics Card',
    969736519: 'Tanium Action Log',
    991644931: 'Workgroup',
    1022769818: 'Is Virtual',
    1039470236: 'SQL Clustered',
    1043670154: 'Disk Free Space Below Threshold',
    1046354727: 'Virtual Platform',
    1092986182: 'Logged In Users',
    1101836903: 'Folder Exists',
    1125023461: 'Boot Device',
    1132013379: 'Open Shares',
    1140552555: 'Internet Explorer Version',
    1154425412: 'DHCP Enabled?',
    1155294592: 'Domain Controller SYSVOL Size',
    1156943497: 'Disk IOPS',
    1206550580: 'Network Link Speed',
    1208633896: 'MAC Address',
    1240245618: 'SQL Database Recovery Mode',
    1260624634: 'Free Memory',
    1260646358: 'CPU Consumption',
    1263879283: 'High Uptime',
    1265351278: 'Application Crashes in Last X Days',
    1271450145: 'Service Login Names',
    1281370578: 'BitLocker Details',
    1302957088: 'Disk Free Space',
    1314534715: 'Security Event Log IDs',
    1315630323: 'Used Memory',
    1326015223: 'FileVault Details',
    1348043492: 'Printers',
    1348161929: 'Default Login Domain',
    1404374135: 'Startup Programs',
    1417112132: 'No Screen Saver Password',
    1426187539: 'Physical Volumes',
    1466668831: 'Wireless Network Connected SSID',
    1471370561: 'DHCP Server',
    1496471156: 'NET Version',
    1497251383: 'Running Service',
    1502679547: 'Monitor Details',
    1509255291: 'Non-Approved Established Connections',
    1511329504: 'Installed Applications',
    1512811088: 'Registry Key Value Exists',
    1526750078: 'Screen Saver Active',
    1527458369: 'High Memory Processes',
    1528412180: 'Established Connections',
    1544486184: 'Operating System Boot Directory',
    1559751995: 'Running Applications',
    1569955801: 'Unencrypted Wireless Networks',
    1579270802: 'Sound Card',
    1580351176: 'BIOS Vendor',
    1591480148: 'System Event Log IDs',
    1591958393: 'Registry Value Data',
    1646244079: 'CPU Speed Mhz',
    1652607578: 'Disk Drive Details',
    1670489640: 'High CPU Consumption',
    1688928675: 'Has Application Management Tools',
    1718946935: 'High Memory Consumption',
    1723627713: 'Local User Password Change Dates',
    1724798097: 'Last System Crash',
    1735107559: 'Network Throughput Outbound',
    1742036917: 'x64/x86?',
    1744818157: 'Tanium Client Subnet',
    1782389954: 'Has Tanium Standard Utilities',
    1785623864: 'Ram Slots Unused',
    1792443391: 'Action Statuses',
    1805210070: 'Tanium PowerShell Execution Policy',
    1806420230: 'Network Printers',
    1810333216: 'Established Ports by Application',
    1815821395: 'Last System Crash in X Days',
    1819649983: 'Network Throughput Percentage',
    1832324705: 'Run Once Keys',
    1845399463: 'SQL Server CPU Consumption',
    1865193433: 'Tanium Server Name List',
    1913997657: 'Username',
    1927765752: 'Active Devices',
    1927941770: 'Last Application Launch Date',
    1978207968: 'System Environment Variables',
    1982695066: 'Operating System Install Date',
    1988427982: 'User Accounts',
    1994896093: 'Driver Details',
    2006202074: 'Time Zone',
    2060254274: 'Local Administrators Without Groups',
    2074877994: 'Recently Closed Connections',
    2095666087: 'Default Login UserID',
    2106396979: 'Logged in User Details',
    2114351169: 'Network Drives Accessed',
    2130080578: 'CPU Manufacturer',
    2154864096: 'Outlook Version',
    2177412849: 'Last Logins',
    2177703669: 'Memory Consumption',
    2183585490: 'Path Permissions',
    2195303088: 'SQL Product Version',
    2207214962: 'Disk Type of C:',
    2222730558: 'Operating System Temp Directory',
    2233537498: 'Wireless Networks Visible',
    2254780098: 'Stopped Service Short Name',
    2265461905: 'Monitor Resolution',
    2290387752: 'Tanium Client Action Folder Sizes',
    2322714946: 'AD Short Domain',
    2344747808: 'SQL Server Databases',
    2353715452: 'Volume Group Names',
    2357545787: 'Predicted Disk Failures',
    2361722934: 'Load Average',
    2370758491: 'Client Time',
    2384520458: 'Service Details',
    2387001299: 'Installed Application Version',
    2417208908: 'Password Policy Details',
    2463256440: 'CPU Architecture',
    2490353155: 'Registry Key Exists',
    2505938414: 'Default Printer',
    2513829483: 'AD Distinguished Name',
    2542613392: 'Manufacturer',
    2574398281: 'Application Event Log Search',
    2581054686: 'Has Hardware Tools',
    2595849133: 'Motherboard Name',
    2607823237: 'Video Graphics Card RAM',
    2614767778: 'UAC Status',
    2620257697: 'Domain Member',
    2623590847: 'Network Throughput Total',
    2634431519: 'Last Date of Local Administrator Login',
    2648511780: 'Packet Loss',
    2671758800: 'Action Lock Status',
    2680423840: 'Local Account Last Password Change Days Ago',
    2704923764: 'PowerShell Version',
    2706539957: 'Local Printers',
    2711879278: 'High CPU Processes',
    2721439124: 'Is Windows',
    2728641061: 'Chassis Type',
    2735360016: 'Tanium Client Neighborhood',
    2753029185: 'Primary Owner Name',
    2758038984: 'Tanium Client Action Timing',
    2759217311: 'BIOS Current Language',
    2783988057: 'Network Adapter Name',
    2800817874: 'Is Mac',
    2811135310: 'Last Reboot',
    2811171321: 'Time Zone Offset',
    2812601404: 'File Creation Date',
    2819106613: 'IP Connections',
    2823285829: 'VMware Guest',
    2845896284: 'Network Throughput Inbound',
    2853143977: 'CPU',
    2866852225: 'TCP connections',
    2881145629: 'Service Pack',
    2932384540: 'Default Web Browser',
    2939169480: 'Low Disk Space',
    2950466201: 'Number Of Users',
    2961425050: 'Model',
    2977419696: 'Subnet Mask',
    2997757654: 'Operating System Language Code',
    3004497651: 'Custom Tags',
    3005061811: 'Has Stale Tanium Client Data',
    3009680784: 'Network Adapter Details',
    3027378756: 'Number of Application Crashes in Last X Days',
    3057103978: 'Windows Server Installed Roles',
    3083322981: 'Number of Processor Cores',
    3103658637: 'Tanium Sensor Randomization Enabled',
    3112892791: 'DNS Server',
    3114455387: 'Internet Explorer Add-Ons',
    3133617106: 'Motherboard Version',
    3133620839: 'Revision of CPU',
    3134254821: 'Java Auto Update',
    3145690673: 'Hardware Device Failed to Load',
    3147407985: 'SQL Recovery Mode',
    3147580256: 'Total Swap',
    3157180652: 'Tanium Client Downloads Directory Details',
    3170446499: 'PCI Device',
    3170496172: 'Number of Logged In Users',
    3177804004: 'Locale Code',
    3188527889: 'Stopped Service',
    3200371050: 'Listen Ports',
    3209138996: 'IP Address',
    3226581166: 'OS Boot Time',
    3271577967: 'SQL Database Count',
    3276808962: 'Network Adapter Type',
    3285711879: 'Registry Key Subkeys',
    3320877330: 'Number of Processors',
    3369713834: 'Organization',
    3394404860: 'Wireless Networks Using WEP',
    3397569679: 'Hosted Wireless Ad-Hoc Networks',
    3409330187: 'Computer Name',
    3418227220: 'Tanium Client Installation Date',
    3418263806: 'Local Account Expiration Details',
    3479253433: 'Tanium Client Installation Time',
    3480890585: 'Uptime',
    3482410175: 'System Directory',
    3499030954: 'Page File Details',
    3518770446: 'Hosts File Entries',
    3554080383: 'Is Linux',
    3556221173: 'Computer ID',
    3575849436: 'Network IP Gateway',
    3595988712: 'USB Write Protected',
    3603927824: 'Installed Pkgs',
    3605572245: 'Human Interface Device',
    3622133010: 'Local Administrators',
    3646624356: 'CPU Cache Size',
    3652459872: 'Tanium Reboot Days Ago',
    3662289857: 'File Exists',
    3682298314: 'Processes Using Module',
    3685017662: 'Is Terminal Server',
    3727949854: 'Client Date',
    3734316770: 'Tanium Client CPU',
    3756702099: 'Is AIX',
    3760050184: 'Tanium Client Explicit Setting',
    3763483691: 'CPU Family',
    3764526140: 'SCSI Controller Driver Name',
    3770282786: 'Operating System Build Number',
    3792181176: 'Is Solaris',
    3796118374: 'SQL Database Sizes',
    3798171813: 'BIOS Release Date',
    3799348944: 'Registry Key Value Names with Data',
    3868118771: 'Used Swap',
    3881863289: 'Folder Contents',
    3891170751: 'System UUID',
    3898138660: 'Tanium Client NAT IP Address',
    3910101228: 'Power Plans Active',
    3914171274: 'CD-ROM Drive Loaded',
    3963156324: 'Attached Battery',
    3993657420: 'Installed Java Runtimes',
    3999173666: 'User Profile Directory Details',
    4018912755: 'Primary WINS Server',
    4055028299: 'CPU Details',
    4058321794: 'Run Keys',
    4070262781: 'Tanium File Contents',
    4076878703: 'Tanium Server Name',
    4080631087: 'File Modification Date',
    4086041268: 'RAM Slots Used and Unused',
    4086596771: 'Tanium Client Logging Level',
    4105783647: 'SCSI Controller Caption',
    4142232197: 'Running Processes',
    4165545489: 'AD Forest',
    4180356655: 'System Disk Free Space',
    4201347922: 'Free Swap',
    4206488295: 'Wireless Network Used by Tanium',
    4212162125: 'Disk Total Size of System Drive',
    4225957259: 'Tanium Current Directory',
    4244179900: 'Run Level',
    4244410676: 'Disk Total Space',
    4254566410: 'System Slots Available',
    4261354259: 'Tanium Peer Address',
    4264207873: 'AD User Groups',
    4264271977: 'Tanium Client IP Address',
    4267153065: 'Wireless Network Details',
    4276555360: 'Registry Key Value Names',
    4279567267: 'RAM',
    4284507739: 'USB Storage Devices',
    4287813257: 'Power Plans Available',
    4293389196: 'Tanium Back Peer Address',
}
