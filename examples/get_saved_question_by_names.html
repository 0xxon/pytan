

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Get saved question by names &mdash; PyTan 1.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="PyTan 1.0.0 documentation" href="../index.html"/>
        <link rel="up" title="pytan API Valid Get Object Examples" href="valid_get_objects.html"/>
        <link rel="next" title="4. Get userrole by id" href="get_userrole_by_id.html"/>
        <link rel="prev" title="2. Get question by id" href="get_question_by_id.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> PyTan</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../description.html">1. Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#why-it-was-created">2. Why it was created</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#requirements">3. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#installation">4. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#usage">5. Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pytan.html">6. pytan package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pytan_examples.html">6.1. pytan API examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.handler.html">6.2. pytan.handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.constants.html">6.3. pytan.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.utils.html">6.4. pytan.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.unittest.html">6.5. pytan Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.functest.html">6.6. pytan Functional Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../taniumpy.html">taniumpy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../taniumpy.session.html">1. taniumpy.session module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../taniumpy.question_asker.html">2. taniumpy.question_asker module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../taniumpy.object_types.html">3. taniumpy.object_types package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../xmltodict.html">7. xmltodict module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ddt.html">8. ddt module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../threaded_http.html">9. threaded_http module</a><ul class="simple">
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PyTan</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../pytan.html">6. pytan package</a> &raquo;</li>
      
          <li><a href="pytan_examples.html">6.1. pytan API examples</a> &raquo;</li>
      
          <li><a href="valid_get_objects.html">pytan API Valid Get Object Examples</a> &raquo;</li>
      
    <li>3. Get saved question by names</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/examples/get_saved_question_by_names.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="get-saved-question-by-names">
<h1>3. Get saved question by names<a class="headerlink" href="#get-saved-question-by-names" title="Permalink to this headline">¶</a></h1>
<p>Get two saved questions by name</p>
<div class="section" id="example-python-code">
<h2>3.1. Example Python Code<a class="headerlink" href="#example-python-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Path to lib directory which contains pytan package</span>
<span class="n">PYTAN_LIB_PATH</span> <span class="o">=</span> <span class="s">&#39;../lib&#39;</span>

<span class="c"># connection info for Tanium Server</span>
<span class="n">USERNAME</span> <span class="o">=</span> <span class="s">&quot;Tanium User&quot;</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s">&quot;T@n!um&quot;</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s">&quot;172.16.31.128&quot;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="s">&quot;444&quot;</span>

<span class="c"># Logging conrols</span>
<span class="n">LOGLEVEL</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">DEBUGFORMAT</span> <span class="o">=</span> <span class="bp">False</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">tempfile</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PYTAN_LIB_PATH</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pytan</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">pytan</span><span class="o">.</span><span class="n">Handler</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="n">USERNAME</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">PASSWORD</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="n">HOST</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">,</span>
    <span class="n">loglevel</span><span class="o">=</span><span class="n">LOGLEVEL</span><span class="p">,</span>
    <span class="n">debugformat</span><span class="o">=</span><span class="n">DEBUGFORMAT</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">print</span> <span class="n">handler</span>

<span class="c"># setup the arguments for the handler method</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;objtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">u&#39;saved_question&#39;</span>
<span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">u&#39;Installed Applications&#39;</span><span class="p">,</span> <span class="s">u&#39;Computer Name&#39;</span><span class="p">]</span>

<span class="c"># call the handler with the get method, passing in kwargs for arguments</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;Type of response: &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;print of response:&quot;</span>
<span class="k">print</span> <span class="n">response</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;length of response (number of objects returned): &quot;</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;print the first object returned in JSON format:&quot;</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="output-from-python-code">
<h2>3.2. Output from Python Code<a class="headerlink" href="#output-from-python-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203</pre></div></td><td class="code"><div class="highlight"><pre>Handler for Session to 172.16.31.128:444, Authenticated: True, Version: 6.2.314.3258

Type of response:  &lt;class &#39;taniumpy.object_types.saved_question_list.SavedQuestionList&#39;&gt;

print of response:
SavedQuestionList, len: 2

length of response (number of objects returned):
2

print the first object returned in JSON format:
{
  &quot;_type&quot;: &quot;saved_question&quot;,
  &quot;action_tracking_flag&quot;: 0,
  &quot;archive_enabled_flag&quot;: 0,
  &quot;archive_owner&quot;: {
    &quot;_type&quot;: &quot;user&quot;,
    &quot;id&quot;: 1,
    &quot;name&quot;: &quot;Jim Olsen&quot;
  },
  &quot;expire_seconds&quot;: 600,
  &quot;hidden_flag&quot;: 0,
  &quot;id&quot;: 92,
  &quot;issue_seconds&quot;: 120,
  &quot;issue_seconds_never_flag&quot;: 0,
  &quot;keep_seconds&quot;: 3600,
  &quot;metadata&quot;: {
    &quot;_type&quot;: &quot;metadata&quot;,
    &quot;item&quot;: [
      {
        &quot;_type&quot;: &quot;item&quot;,
        &quot;admin_flag&quot;: 0,
        &quot;name&quot;: &quot;defined&quot;,
        &quot;value&quot;: &quot;Tanium&quot;
      },
      {
        &quot;_type&quot;: &quot;item&quot;,
        &quot;admin_flag&quot;: 0,
        &quot;name&quot;: &quot;category&quot;,
        &quot;value&quot;: &quot;Tanium&quot;
      }
    ]
  },
  &quot;mod_time&quot;: &quot;2014-12-06T18:01:38&quot;,
  &quot;mod_user&quot;: {
    &quot;_type&quot;: &quot;user&quot;,
    &quot;name&quot;: &quot;Jim Olsen&quot;
  },
  &quot;most_recent_question_id&quot;: 989,
  &quot;name&quot;: &quot;Installed Applications&quot;,
  &quot;packages&quot;: {
    &quot;_type&quot;: &quot;package_specs&quot;,
    &quot;package_spec&quot;: []
  },
  &quot;public_flag&quot;: 1,
  &quot;query_text&quot;: &quot;Get Installed Applications from all machines&quot;,
  &quot;question&quot;: {
    &quot;_type&quot;: &quot;question&quot;,
    &quot;action_tracking_flag&quot;: 0,
    &quot;expiration&quot;: &quot;2014-12-07T06:12:22&quot;,
    &quot;expire_seconds&quot;: 0,
    &quot;force_computer_id_flag&quot;: 0,
    &quot;hidden_flag&quot;: 0,
    &quot;id&quot;: 989,
    &quot;management_rights_group&quot;: {
      &quot;_type&quot;: &quot;group&quot;,
      &quot;id&quot;: 0
    },
    &quot;query_text&quot;: &quot;Get Installed Applications from all machines&quot;,
    &quot;saved_question&quot;: {
      &quot;_type&quot;: &quot;saved_question&quot;,
      &quot;id&quot;: 92
    },
    &quot;selects&quot;: {
      &quot;_type&quot;: &quot;selects&quot;,
      &quot;select&quot;: [
        {
          &quot;_type&quot;: &quot;select&quot;,
          &quot;filter&quot;: {
            &quot;_type&quot;: &quot;filter&quot;,
            &quot;all_times_flag&quot;: 0,
            &quot;all_values_flag&quot;: 0,
            &quot;delimiter_index&quot;: 0,
            &quot;end_time&quot;: &quot;2001-01-01T00:00:00&quot;,
            &quot;ignore_case_flag&quot;: 1,
            &quot;max_age_seconds&quot;: 0,
            &quot;not_flag&quot;: 0,
            &quot;operator&quot;: &quot;Less&quot;,
            &quot;start_time&quot;: &quot;2001-01-01T00:00:00&quot;,
            &quot;substring_flag&quot;: 0,
            &quot;substring_length&quot;: 0,
            &quot;substring_start&quot;: 0,
            &quot;utf8_flag&quot;: 0,
            &quot;value_type&quot;: &quot;String&quot;
          },
          &quot;sensor&quot;: {
            &quot;_type&quot;: &quot;sensor&quot;,
            &quot;category&quot;: &quot;Applications&quot;,
            &quot;creation_time&quot;: &quot;2014-12-06T18:00:21&quot;,
            &quot;delimiter&quot;: &quot;|&quot;,
            &quot;description&quot;: &quot;List of the applications and versions of those applications installed on the client machine.\nExample: Mozilla Firefox | 16.0.1&quot;,
            &quot;exclude_from_parse_flag&quot;: 1,
            &quot;hash&quot;: 1511329504,
            &quot;hidden_flag&quot;: 0,
            &quot;id&quot;: 41,
            &quot;ignore_case_flag&quot;: 1,
            &quot;last_modified_by&quot;: &quot;Jim Olsen&quot;,
            &quot;max_age_seconds&quot;: 600,
            &quot;metadata&quot;: {
              &quot;_type&quot;: &quot;metadata&quot;,
              &quot;item&quot;: [
                {
                  &quot;_type&quot;: &quot;item&quot;,
                  &quot;admin_flag&quot;: 0,
                  &quot;name&quot;: &quot;defined&quot;,
                  &quot;value&quot;: &quot;Tanium&quot;
                }
              ]
            },
            &quot;modification_time&quot;: &quot;2014-12-06T18:00:21&quot;,
            &quot;name&quot;: &quot;Installed Applications&quot;,
            &quot;queries&quot;: {
              &quot;_type&quot;: &quot;queries&quot;,
              &quot;query&quot;: [
                {
                  &quot;_type&quot;: &quot;query&quot;,
                  &quot;platform&quot;: &quot;Windows&quot;,
                  &quot;script&quot;: &quot;&amp;#039;========================================\n&amp;#039; Installed Applications\n&amp;#039;========================================\n&amp;#039;@INCLUDE=utils/SensorRandomization/SensorRandomizationFunctions.vbs\n&amp;#039; This sensor will return information in the uninstall areas of the registry.\n&amp;#039; There are two hidden columns which can be filtered on despite the fact that\n&amp;#039; they&amp;#039;re hidden, and can also feed actions.\n&amp;#039; if the uninstallstring is msi based, it is altered to show the\n&amp;#039; silent uninstall options and marked as &amp;quot;Is Uninstallable&amp;quot;\n&amp;#039; finally, if it&amp;#039;s a user installed application, it will note that\n&amp;#039; The columns look like:\n&amp;#039; Name|Version|Silent Uninstall String|Uninstallable\n\nSensorRandomize()\n\nSet objRegistry = Getx64RegistryProvider()\n\nkeyPath = &amp;quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall&amp;quot;\nkey64Path = &amp;quot;SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall&amp;quot;\n\nConst HKLM = &amp;amp;H80000002\nConst HKEY_USERS = &amp;amp;H80000003\n\n&amp;#039; list out 32-bit applications on a 64-bit system\nIf RegKeyExists(HKLM, key64Path) Then\n\tobjRegistry.EnumKey HKLM, key64Path, arrSubKeys\n\tGetApplications HKLM,key64path,arrSubKeys\nEnd If\n\n&amp;#039; list out 32-bit applications on a 32-bit system, or 64-bit applications\n&amp;#039; on a 64-bit system.\nIf RegKeyExists(HKLM, keyPath) Then\n\tobjRegistry.EnumKey HKLM, keypath, arrSubKeys\n\tGetApplications HKLM,keypath,arrSubKeys\nEnd If\n\n&amp;#039; Also list out applications installed to HKEY_Users areas\n&amp;#039; which will be appended to the arrSubKeys\nobjRegistry.EnumKey HKEY_USERS, &amp;quot;&amp;quot;, arrUserKeys\nFor Each strSIDkey In arrUserKeys\n\tIf RegKeyExists(HKEY_USERS, strSIDKEY&amp;amp;&amp;quot;\\&amp;quot;&amp;amp;keyPath) Then\n\t\tobjRegistry.EnumKey HKEY_USERS, strSIDkey&amp;amp;&amp;quot;\\&amp;quot;&amp;amp;keyPath, arrSubKeys\n\t\tGetApplications HKEY_USERS,strSIDKey&amp;amp;&amp;quot;\\&amp;quot;&amp;amp;keyPath,arrSubKeys\n\tEnd If\nNext\n\n\nFunction GetApplications(HIVE, keypath,arrSubKeys)\n\tSet applications = CreateObject(&amp;quot;Scripting.Dictionary&amp;quot;)\n\tOn Error Resume Next\n\tFor Each key in arrSubKeys\n\t\tobjRegistry.GetStringValue HIVE,keyPath &amp;amp; &amp;quot;\\&amp;quot; &amp;amp; key,&amp;quot;DisplayName&amp;quot;, displayName\n\t\tobjRegistry.GetStringValue HIVE,keyPath &amp;amp; &amp;quot;\\&amp;quot; &amp;amp; key,&amp;quot;DisplayVersion&amp;quot;, version\n\t\tobjRegistry.GetDWORDValue HIVE,keyPath &amp;amp; &amp;quot;\\&amp;quot; &amp;amp; key,&amp;quot;SystemComponent&amp;quot;, systemComponent\t\n\t\tobjRegistry.GetStringValue HIVE,keyPath &amp;amp; &amp;quot;\\&amp;quot; &amp;amp; key,&amp;quot;UninstallString&amp;quot;, uninstallString\t\n\t\tobjRegistry.GetStringValue HIVE,keyPath &amp;amp; &amp;quot;\\&amp;quot; &amp;amp; key,&amp;quot;ParentKeyName&amp;quot;, parentKey\t\n\t\t&amp;#039; on error goto 0\n\t\t&amp;#039; assume it&amp;#039;s not uninstallable\n\t\tbUninstallable = &amp;quot;Not Uninstallable&amp;quot;\n\t\t\t\t\n\t\tIf displayName &amp;lt;&amp;gt; &amp;quot;&amp;quot; _\n\t\t\tAnd Not IsNull(uninstallString) _ \n\t\t\tAnd IsNull(parentKey) _\n\t\t\tAnd InStr(displayName, &amp;quot;Hotfix&amp;quot;) = 0 _\n\t\t\tAnd InStr(displayName, &amp;quot;Update for&amp;quot;) = 0 _\n\t \t\tAnd InStr(displayName, &amp;quot;Security Update for&amp;quot;) = 0 _\n\t \tThen \n\t \t\tIf InStr(LCase(uninstallString), &amp;quot;msiexec&amp;quot;) Then\n\t \t\t\t&amp;#039; replace any /I with /X and add silent flags\n\t \t\t\tuninstallString = Replace(uninstallString,&amp;quot;/I&amp;quot;,&amp;quot;/X&amp;quot;) &amp;amp; &amp;quot; /qn /noreboot&amp;quot; \n\t  \t\t\tbUninstallable = &amp;quot;Is Uninstallable&amp;quot;\n\t  \t\tEnd If\n\t \t\tIf IsNull(systemComponent) Or systemComponent = 0 Then\n\t\t\t\tIf IsNull(version) Then\n\t\t\t\t\tversion = GetVersionInString(displayName)\n\t\t\t\tEnd If\n\t\t\t\t&amp;#039; This is a multi-column sensor.  Last two columns are hidden.\n\n\t\t\t\tdisplayString = displayName &amp;amp; &amp;quot;|&amp;quot; &amp;amp; version &amp;amp; &amp;quot;|&amp;quot; &amp;amp; uninstallString &amp;amp; &amp;quot;|&amp;quot; &amp;amp; bUninstallable\n\n\t\t\t\t&amp;#039; treat displayString as the unique value - cannot be listed twice.\n\t\t\t\tIf Not applications.Exists(displayString) Then\n\t\t\t\t\tapplications.Add displayString, &amp;quot;&amp;quot;\n\t\t\t\tEnd If \t\n\t\t\tEnd If \t\n\t\tEnd If \n\tNext\n\tOn Error Goto 0\n\t\n\tSortDictionary applications, 1 &amp;#039; This calls a sorting function specific to dictionaries\n\tarrApplicationsKeys = applications.Keys\n\tFor Each application In arrApplicationsKeys\n\t\t&amp;#039; final output of the sensor\n\t\tWScript.Echo CleanCharacters(application)\n\tNext\nEnd Function &amp;#039;GetApplications\n\nFunction RegKeyExists(sHive, sRegKey)\n\tDim aValueNames, aValueTypes\n\tIf objRegistry.EnumValues(sHive, sRegKey, aValueNames, aValueTypes) = 0 Then\n\t\tRegKeyExists = True\n\tElse\n\t\tRegKeyExists = False\n\tEnd If\nEnd Function\n\nFunction SortDictionary(objDict, intSort)\n &amp;#039;   objDict - the dictionary to sort\n &amp;#039;   intSort - the field to sort (1=key, 2=item)\n \n   &amp;#039; declare constants\n   Const dictKey  = 1\n   Const dictItem = 2\n \n   &amp;#039; declare our variables\n   Dim strDict()\n   Dim objKey\n   Dim strKey,strItem\n   Dim X,Y,Z\n \n   &amp;#039; get the dictionary count\n   Z = objDict.Count\n \n   &amp;#039; we need more than one item to warrant sorting\n   If Z &amp;gt; 1 Then\n     &amp;#039; create an array to store dictionary information\n     ReDim strDict(Z,2)\n     X = 0\n     &amp;#039; populate the string array\n     For Each objKey In objDict\n         strDict(X,dictKey)  = CStr(objKey)\n         strDict(X,dictItem) = CStr(objDict(objKey))\n         X = X + 1\n     Next\n \n     &amp;#039; perform a a shell sort of the string array\n     For X = 0 To (Z - 2)\n       For Y = X To (Z - 1)\n         If StrComp(strDict(X,intSort),strDict(Y,intSort),vbTextCompare) &amp;gt; 0 Then\n             strKey  = strDict(X,dictKey)\n             strItem = strDict(X,dictItem)\n             strDict(X,dictKey)  = strDict(Y,dictKey)\n             strDict(X,dictItem) = strDict(Y,dictItem)\n             strDict(Y,dictKey)  = strKey\n             strDict(Y,dictItem) = strItem\n         End If\n       Next\n     Next\n \n     &amp;#039; erase the contents of the dictionary object\n     objDict.RemoveAll\n \n     &amp;#039; repopulate the dictionary with the sorted information\n     For X = 0 To (Z - 1)\n       objDict.Add strDict(X,dictKey), strDict(X,dictItem)\n     Next\n \n   End If\n End Function &amp;#039;SortDictionary\n\nFunction GetVersionInString(ByVal strTemp)\n&amp;#039; examines a string and returns a version string at the end of it\n\tDim strOut\n\tstrOut = &amp;quot;&amp;quot;\n\tIf Not IsNull(strTemp) Then\n\t\tstrTemp = StrReverse(strTemp)\n\t\tDim strLookAtChar,intCurPos\n\t\tDim bNumbersStartMarked : bNumbersStartMarked = False\n\n\t\tFor intCurPos = 1 To Len(strTemp)\t\t\n\t\t\tstrLookAtChar = Mid(strTemp,intCurPos,1)\n\t\t\tIf IsNumeric(strLookAtChar) Or strLookAtChar = &amp;quot;.&amp;quot; Or strLookAtChar = &amp;quot;-&amp;quot; Then\n\t\t\t\tbNumbersStartMarked = True\n\t\t\t\tstrOut = strOut &amp;amp; strLookAtChar\n\t\t\tEnd If\n\t\tIf bNumbersStartMarked And ( (Not IsNumeric(strLookAtChar) And strLookAtChar &amp;lt;&amp;gt; &amp;quot;.&amp;quot; And strLookAtChar &amp;lt;&amp;gt; &amp;quot;-&amp;quot;) ) Then\n\t\t\tExit For\n\t\tEnd If\t\n\t\tNext\n\t\tstrOut = StrReverse(strOut)\n\tElse\n\t\tstrOut = &amp;quot;&amp;quot;\n\tEnd If\n\t\n\tIf Len(strOut) = 0 Then strOut = &amp;quot;N/A&amp;quot;\n\t\n\tGetVersionInString = strOut\n\t\nEnd Function &amp;#039;GetVersionInString\n\nFunction CleanCharacters(strTest)\n&amp;#039; String returned will not have characters in the output which\n&amp;#039; are not friendly to the console app\n\tstrPattern = &amp;quot;[^\\x20-\\x7E]&amp;quot;\n\tstrReplace = &amp;quot;&amp;quot;\n\tSet objRegExp = New RegExp\n\tobjRegExp.Global = True\n\tobjRegExp.IgnoreCase = True\n\tobjRegExp.Pattern = strPattern\n\tobjRegExp.Global = True\n\tCleanCharacters = objRegExp.Replace(strTest, strReplace)\nEnd Function\n\nFunction Getx64RegistryProvider\n    &amp;#039; Returns the best available registry provider:  32 bit on 32 bit systems, 64 bit on 64 bit systems\n    Dim objWMIService, colItems, objItem, iArchType, objCtx, objLocator, objServices, objRegProv\n    Set objWMIService = GetObject(&amp;quot;winmgmts:\\\\.\\root\\CIMV2&amp;quot;)\n    Set colItems = objWMIService.ExecQuery(&amp;quot;Select SystemType from Win32_ComputerSystem&amp;quot;)    \n    For Each objItem In colItems\n        If InStr(LCase(objItem.SystemType), &amp;quot;x64&amp;quot;) &amp;gt; 0 Then\n            iArchType = 64\n        Else\n            iArchType = 32\n        End If\n    Next\n    \n    Set objCtx = CreateObject(&amp;quot;WbemScripting.SWbemNamedValueSet&amp;quot;)\n    objCtx.Add &amp;quot;__ProviderArchitecture&amp;quot;, iArchType\n    Set objLocator = CreateObject(&amp;quot;Wbemscripting.SWbemLocator&amp;quot;)\n    Set objServices = objLocator.ConnectServer(&amp;quot;&amp;quot;,&amp;quot;root\\default&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;,,,,objCtx)\n    Set objRegProv = objServices.Get(&amp;quot;StdRegProv&amp;quot;)   \n    \n    Set Getx64RegistryProvider = objRegProv\nEnd Function &amp;#039; Getx64RegistryProvider\n&amp;#039;------------ INCLUDES after this line. Do not edit past this point -----\n&amp;#039;- Begin file: utils/SensorRandomization/SensorRandomizationFunctions.vbs\n&amp;#039;&amp;#039; -- Begin Random Sleep Functions -- &amp;#039;&amp;#039;\n\nDim bSensorRandomizeDebugOutput : bSensorRandomizeDebugOutput = False\n\nFunction SensorRandomizeLow()\n    Dim intSensorRandomizeWaitLow : intSensorRandomizeWaitLow = 10\n    SensorRandomizeRandomSleep(intSensorRandomizeWaitLow)\nEnd Function &amp;#039; SensorRandomizeLow\n\nFunction SensorRandomize()\n    Dim intSensorRandomizeWaitMed : intSensorRandomizeWaitMed = 20\n    SensorRandomizeRandomSleep(intSensorRandomizeWaitMed)\nEnd Function &amp;#039; SensorRandomize\n\nFunction SensorRandomizeHigh()\n    Dim intSensorRandomizeWaitHigh : intSensorRandomizeWaitHigh = 30\n    SensorRandomizeRandomSleep(intSensorRandomizeWaitHigh)\nEnd Function &amp;#039; SensorRandomize\n\nFunction SensorRandomizeRandomSleep(intSleepTime)\n&amp;#039; sleeps for a random period of time, intSleepTime is in seconds\n&amp;#039; if the sensor randomize flag is on\n&amp;#039; RandomizeScalingFactor is a multiplier on the values hardcoded in the sensor\n&amp;#039; not typically set but can adjust timings per endpoint, optionally\n\tDim intSensorRandomizeWaitTime\n\tDim objShell,intRandomizeFlag,strRandomizeRegPath,intRandomizeScalingPercentage\n\tstrRandomizeRegPath = SensorRandomizeGetTaniumRegistryPath&amp;amp;&amp;quot;\\Sensor Data\\Random Sleep&amp;quot;\n\t\n\tSet objShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)\n\tOn Error Resume Next\n\tintRandomizeFlag = objShell.RegRead(&amp;quot;HKLM\\&amp;quot;&amp;amp;strRandomizeRegPath&amp;amp;&amp;quot;\\SensorRandomizeFlag&amp;quot;)\n\tintRandomizeScalingPercentage = objShell.RegRead(&amp;quot;HKLM\\&amp;quot;&amp;amp;strRandomizeRegPath&amp;amp;&amp;quot;\\SensorRandomizeScalingPercentage&amp;quot;)\n\tOn Error Goto 0\n\tIf intRandomizeFlag &amp;gt; 0 Then\n\t\tIf intRandomizeScalingPercentage &amp;gt; 0 Then\n\t\t\tintSleepTime = intRandomizeScalingPercentage * .01 * intSleepTime\n\t\t\tSensorRandomizeEcho &amp;quot;Randomize scaling percentage of &amp;quot; _ \n\t\t\t\t&amp;amp; intRandomizeScalingPercentage &amp;amp; &amp;quot; applied, new sleep time is &amp;quot; &amp;amp; intSleepTime\n\t\tEnd If\n\t\tintSensorRandomizeWaitTime = CLng(intSleepTime) * 1000 &amp;#039; convert to milliseconds\n\t\t&amp;#039; wait random interval between 0 and the max\n\t\tRandomize(SensorRandomizeTaniumRandomSeed)\n\t\t&amp;#039; assign random value to wait time max value\n\t\tintSensorRandomizeWaitTime = Int( ( intSensorRandomizeWaitTime + 1 ) * Rnd )\n\t\tSensorRandomizeEcho &amp;quot;Sleeping for &amp;quot; &amp;amp; intSensorRandomizeWaitTime &amp;amp; &amp;quot; milliseconds&amp;quot;\n\t\tWScript.Sleep(intSensorRandomizeWaitTime)\n\t\tSensorRandomizeEcho &amp;quot;Done sleeping, continuing ...&amp;quot;\n\tElse \n\t\tSensorRandomizeEcho &amp;quot;SensorRandomize Not Enabled - No Op&amp;quot;\n\tEnd If\nEnd Function &amp;#039;SensorRandomizeRandomSleep\n\nFunction SensorRandomizeTaniumRandomSeed\n&amp;#039; for randomizing sensor code, the default seed is not random enough\n\tDim timerNum\n\ttimerNum = Timer()\n\tIf timerNum &amp;lt; 1 Then\n\t\tSensorRandomizeTaniumRandomSeed = (SensorRandomizeGetTaniumComputerID / Timer() * 10 )\n\tElse\n\t\tSensorRandomizeTaniumRandomSeed = SensorRandomizeGetTaniumComputerID / Timer\n\tEnd If\nEnd Function &amp;#039;SensorRandomizeTaniumRandomSeed\n\nFunction SensorRandomizeGetTaniumRegistryPath\n&amp;#039;SensorRandomizeGetTaniumRegistryPath works in x64 or x32\n&amp;#039;looks for a valid Path value\n\n\tDim objShell\n\tDim keyNativePath, keyWoWPath, strPath, strFoundTaniumRegistryPath\n\t  \n    Set objShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)\n    \n\tkeyNativePath = &amp;quot;Software\\Tanium\\Tanium Client&amp;quot;\n\tkeyWoWPath = &amp;quot;Software\\Wow6432Node\\Tanium\\Tanium Client&amp;quot;\n    \n    &amp;#039; first check the Software key (valid for 32-bit machines, or 64-bit machines in 32-bit mode)\n    On Error Resume Next\n    strPath = objShell.RegRead(&amp;quot;HKLM\\&amp;quot;&amp;amp;keyNativePath&amp;amp;&amp;quot;\\Path&amp;quot;)\n    On Error Goto 0\n\tstrFoundTaniumRegistryPath = keyNativePath\n \n  \tIf strPath = &amp;quot;&amp;quot; Then\n  \t\t&amp;#039; Could not find 32-bit mode path, checking Wow6432Node\n  \t\tOn Error Resume Next\n  \t\tstrPath = objShell.RegRead(&amp;quot;HKLM\\&amp;quot;&amp;amp;keyWoWPath&amp;amp;&amp;quot;\\Path&amp;quot;)\n  \t\tOn Error Goto 0\n\t\tstrFoundTaniumRegistryPath = keyWoWPath\n  \tEnd If\n  \t\n  \tIf Not strPath = &amp;quot;&amp;quot; Then\n  \t\tSensorRandomizeGetTaniumRegistryPath = strFoundTaniumRegistryPath\n  \tElse\n  \t\tSensorRandomizeGetTaniumRegistryPath = False\n  \t\tWScript.Echo &amp;quot;Error: Cannot locate Tanium Registry Path&amp;quot;\n  \tEnd If\nEnd Function &amp;#039;SensorRandomizeGetTaniumRegistryPath\n\nFunction SensorRandomizeGetTaniumComputerID\n&amp;#039;&amp;#039; This function gets the Tanium Computer ID\n\tDim objShell\n\tDim intClientID,strID,strKeyPath,strValueName\n\t\n    strKeyPath = SensorRandomizeGetTaniumRegistryPath\n    strValueName = &amp;quot;ComputerID&amp;quot;\n    Set objShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)\n    On Error Resume Next\n    intClientID = objShell.RegRead(&amp;quot;HKLM\\&amp;quot;&amp;amp;strKeyPath&amp;amp;&amp;quot;\\&amp;quot;&amp;amp;strValueName)\n    If Err.Number &amp;lt;&amp;gt; 0 Then\n    \tSensorRandomizeGetTaniumComputerID = 0\n    Else\n\t\tSensorRandomizeGetTaniumComputerID = SensorRandomizeReinterpretSignedAsUnsigned(intClientID)\n\tEnd If\n\tOn Error Goto 0\nEnd Function &amp;#039;SensorRandomizeGetTaniumComputerID\n\nFunction SensorRandomizeReinterpretSignedAsUnsigned(ByVal x)\n\t  If x &amp;lt; 0 Then x = x + 2^32\n\t  SensorRandomizeReinterpretSignedAsUnsigned = x\nEnd Function &amp;#039;SensorRandomizeReinterpretSignedAsUnsigned\n\nSub SensorRandomizeEcho(str)\n\tIf bSensorRandomizeDebugOutput = true Then WScript.Echo str\nEnd Sub &amp;#039;SensorRandomizeEcho\n&amp;#039; -- End Random Sleep Functions --&amp;#039;\n&amp;#039;- End file: utils/SensorRandomization/SensorRandomizationFunctions.vbs&quot;,
                  &quot;script_type&quot;: &quot;VBScript&quot;
                },
                {
                  &quot;_type&quot;: &quot;query&quot;,
                  &quot;platform&quot;: &quot;Linux&quot;,
                  &quot;script&quot;: &quot;#!/bin/sh\n# Detects which OS and if it is Linux then it will detect which Linux\n# Distribution.\n\n# Can be used as a starting point for shell scripts that need to work differently on\n# Mac, and various flavors of Linux\n\nOS=`uname -s`\n\nGetVersionFromFile()\n{\n    VERSION=`cat $1 | tr &amp;quot;\\n&amp;quot; &amp;#039; &amp;#039; | sed s/.*VERSION.*=\\ // `\n}\n\nif [ &amp;quot;${OS}&amp;quot; = &amp;quot;Linux&amp;quot; ] ; then\n    KERNEL=`uname -r`\n    if [ -f /etc/redhat-release ] ; then\n        # Redhat based system\n        rpm -qa --queryformat &amp;quot;%{NAME}|%{VERSION}|nothing|Not Uninstallable\\n&amp;quot;\n    elif [ -f /etc/SuSE-release ] ; then\n        # SuSE / OpenSuSE based system\n        rpm -qa --queryformat &amp;quot;%{NAME}|%{VERSION}|nothing|Not Uninstallable\\n&amp;quot;\n    elif [ -f /etc/lsb-release ] ; then\n        # Usually Ubuntu -- this is a Linux Standard Based system, which\n        # Ubuntu is by far the biggest.  But general LSB commands should work\n        dpkg -l | awk &amp;#039;{print $2&amp;quot;|&amp;quot;$3&amp;quot;|nothing|Not Uninstallable&amp;quot;}&amp;#039;\n    elif [ -f /etc/debian_version ] ; then\n        # Debian -- note that Ubuntu is Debian based, but Debian does not have a\n        # lsb-release file\n        dpkg -l | awk &amp;#039;{print $2&amp;quot;|&amp;quot;$3&amp;quot;|nothing|Not Uninstallable&amp;quot;}&amp;#039;\n        #else\n\t# a less common distribution.  Most all really popular distributions will\n        # be caught by the tree above.\n    fi\n#else\n   # not Linux -- could be anything, BSD / Solaris / AIX / etc\nfi\n\necho ${OSSTR}\n&quot;,
                  &quot;script_type&quot;: &quot;UnixShell&quot;
                },
                {
                  &quot;_type&quot;: &quot;query&quot;,
                  &quot;platform&quot;: &quot;Mac&quot;,
                  &quot;script&quot;: &quot;#!/bin/bash\n\nnotcontains() {\n    string=&amp;quot;$1&amp;quot;\n    substring=&amp;quot;$2&amp;quot;\n    if test &amp;quot;${string#*$substring}&amp;quot; != &amp;quot;$string&amp;quot;\n    then\n        return 1    # $substring is not in $string\n    else\n        return 0    # $substring is in $string\n    fi\n}\n\nftemp=$(mktemp -t &amp;#039;apps.xml&amp;#039;)\nsystem_profiler -xml SPApplicationsDataType &amp;gt; &amp;quot;$ftemp&amp;quot;\n\ncount=1\n\nwhile true\ndo\n        app=`/usr/libexec/PlistBuddy -c &amp;quot;Print :0:_items:$count:_name&amp;quot; $ftemp 2&amp;gt;/dev/null`\n        version=`/usr/libexec/PlistBuddy -c &amp;quot;Print :0:_items:$count:version&amp;quot; $ftemp 2&amp;gt;/dev/null`\n        if [ -z &amp;quot;$app&amp;quot; ]; then\n                break\n        fi\n        test=&amp;quot;VMware&amp;quot;\n        if notcontains &amp;quot;$version&amp;quot; &amp;quot;$test&amp;quot;; then\n                echo $app&amp;quot;|&amp;quot;$version&amp;quot;|nothing|Not Uninstallable&amp;quot;\n        fi\n        let count=count+1\ndone\nrm -rf &amp;quot;$ftemp&amp;quot;\n&quot;,
                  &quot;script_type&quot;: &quot;UnixShell&quot;
                }
              ]
            },
            &quot;source_id&quot;: 0,
            &quot;string_count&quot;: 3215,
            &quot;subcolumns&quot;: {
              &quot;_type&quot;: &quot;subcolumns&quot;,
              &quot;subcolumn&quot;: [
                {
                  &quot;_type&quot;: &quot;subcolumn&quot;,
                  &quot;hidden_flag&quot;: 0,
                  &quot;ignore_case_flag&quot;: 1,
                  &quot;index&quot;: 0,
                  &quot;name&quot;: &quot;Name&quot;,
                  &quot;value_type&quot;: &quot;String&quot;
                },
                {
                  &quot;_type&quot;: &quot;subcolumn&quot;,
                  &quot;hidden_flag&quot;: 0,
                  &quot;ignore_case_flag&quot;: 1,
                  &quot;index&quot;: 1,
                  &quot;name&quot;: &quot;Version&quot;,
                  &quot;value_type&quot;: &quot;Version&quot;
                },
                {
                  &quot;_type&quot;: &quot;subcolumn&quot;,
                  &quot;hidden_flag&quot;: 1,
                  &quot;ignore_case_flag&quot;: 1,
                  &quot;index&quot;: 2,
                  &quot;name&quot;: &quot;Silent Uninstall String&quot;,
                  &quot;value_type&quot;: &quot;String&quot;
                },
                {
                  &quot;_type&quot;: &quot;subcolumn&quot;,
                  &quot;hidden_flag&quot;: 1,
                  &quot;ignore_case_flag&quot;: 1,
                  &quot;index&quot;: 3,
                  &quot;name&quot;: &quot;Uninstallable&quot;,
                  &quot;value_type&quot;: &quot;String&quot;
                }
              ]
            },
            &quot;value_type&quot;: &quot;String&quot;
          }
        }
      ]
    },
    &quot;skip_lock_flag&quot;: 0,
    &quot;user&quot;: {
      &quot;_type&quot;: &quot;user&quot;,
      &quot;id&quot;: 2,
      &quot;name&quot;: &quot;Tanium User&quot;
    }
  },
  &quot;row_count_flag&quot;: 0,
  &quot;sort_column&quot;: 0,
  &quot;user&quot;: {
    &quot;_type&quot;: &quot;user&quot;,
    &quot;id&quot;: 1,
    &quot;name&quot;: &quot;Jim Olsen&quot;
  }
}
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="get_userrole_by_id.html" class="btn btn-neutral float-right" title="4. Get userrole by id">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="get_question_by_id.html" class="btn btn-neutral" title="2. Get question by id"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Tanium.
      Last updated on Dec 08, 2014.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>