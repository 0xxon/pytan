

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.1.11.12. Export basetype csv with sort list &mdash; PyTan 1.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="PyTan 1.0.0 documentation" href="../index.html"/>
        <link rel="up" title="6.1.11. pytan API Valid Export BaseType Examples" href="valid_export_basetype.html"/>
        <link rel="next" title="6.1.11.13. Export basetype json default options" href="export_basetype_json_default_options.html"/>
        <link rel="prev" title="6.1.11.11. Export basetype csv with sort true" href="export_basetype_csv_with_sort_true.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> PyTan</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../description.html">1. Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#why-it-was-created">2. Why it was created</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#requirements">3. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#installation">4. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#usage">5. Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pytan.html">6. pytan package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pytan_examples.html">6.1. pytan API examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.handler.html">6.2. pytan.handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.constants.html">6.3. pytan.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.utils.html">6.4. pytan.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.unittest.html">6.5. pytan Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytan.functest.html">6.6. pytan Functional Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../taniumpy.html">7. taniumpy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../taniumpy.session.html">1. taniumpy.session module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../taniumpy.question_asker.html">2. taniumpy.question_asker module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../taniumpy.object_types.html">3. taniumpy.object_types package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../xmltodict.html">7. xmltodict module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ddt.html">8. ddt module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../threaded_http.html">9. threaded_http module</a><ul class="simple">
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PyTan</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../pytan.html">6. pytan package</a> &raquo;</li>
      
          <li><a href="pytan_examples.html">6.1. pytan API examples</a> &raquo;</li>
      
          <li><a href="valid_export_basetype.html">6.1.11. pytan API Valid Export BaseType Examples</a> &raquo;</li>
      
    <li>6.1.11.12. Export basetype csv with sort list</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/examples/export_basetype_csv_with_sort_list.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="export-basetype-csv-with-sort-list">
<h1>6.1.11.12. Export basetype csv with sort list<a class="headerlink" href="#export-basetype-csv-with-sort-list" title="Permalink to this headline">¶</a></h1>
<p>Export a BaseType from getting objects as CSV with name and description for header_sort</p>
<div class="section" id="example-python-code">
<h2>6.1.11.12.1. Example Python Code<a class="headerlink" href="#example-python-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Path to lib directory which contains pytan package</span>
<span class="n">PYTAN_LIB_PATH</span> <span class="o">=</span> <span class="s">&#39;../lib&#39;</span>

<span class="c"># connection info for Tanium Server</span>
<span class="n">USERNAME</span> <span class="o">=</span> <span class="s">&quot;Tanium User&quot;</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s">&quot;T@n!um&quot;</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s">&quot;172.16.31.128&quot;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="s">&quot;444&quot;</span>

<span class="c"># Logging conrols</span>
<span class="n">LOGLEVEL</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">DEBUGFORMAT</span> <span class="o">=</span> <span class="bp">False</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">tempfile</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PYTAN_LIB_PATH</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pytan</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">pytan</span><span class="o">.</span><span class="n">Handler</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="n">USERNAME</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">PASSWORD</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="n">HOST</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">,</span>
    <span class="n">loglevel</span><span class="o">=</span><span class="n">LOGLEVEL</span><span class="p">,</span>
    <span class="n">debugformat</span><span class="o">=</span><span class="n">DEBUGFORMAT</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">print</span> <span class="n">handler</span>

<span class="c"># setup the export_obj kwargs for later</span>
<span class="n">export_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">export_kwargs</span><span class="p">[</span><span class="s">&quot;export_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">u&#39;csv&#39;</span>
<span class="n">export_kwargs</span><span class="p">[</span><span class="s">&quot;header_sort&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">u&#39;name&#39;</span><span class="p">,</span> <span class="s">u&#39;description&#39;</span><span class="p">]</span>

<span class="c"># get the objects that will provide the basetype that we want to use</span>
<span class="n">get_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">&quot;Computer Name&quot;</span><span class="p">,</span> <span class="s">&quot;IP Route Details&quot;</span><span class="p">,</span> <span class="s">&quot;IP Address&quot;</span><span class="p">,</span>
        <span class="s">&#39;Folder Name Search with RegEx Match&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s">&#39;objtype&#39;</span><span class="p">:</span> <span class="s">&#39;sensor&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">**</span><span class="n">get_kwargs</span><span class="p">)</span>

<span class="c"># export the object to a string</span>
<span class="c"># (we could just as easily export to a file using export_to_report_file)</span>
<span class="n">export_kwargs</span><span class="p">[</span><span class="s">&#39;obj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">response</span>
<span class="n">export_str</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">export_obj</span><span class="p">(</span><span class="o">**</span><span class="n">export_kwargs</span><span class="p">)</span>


<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;print the export_str returned from export_obj():&quot;</span>
<span class="k">print</span> <span class="n">export_str</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="output-from-python-code">
<h2>6.1.11.12.2. Output from Python Code<a class="headerlink" href="#output-from-python-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353</pre></div></td><td class="code"><div class="highlight"><pre>Handler for Session to 172.16.31.128:444, Authenticated: True, Version: 6.2.314.3258

print the export_str returned from export_obj():
name,description,category,creation_time,delimiter,exclude_from_parse_flag,hash,hidden_flag,id,ignore_case_flag,last_modified_by,max_age_seconds,metadata_item_0_admin_flag,metadata_item_0_name,metadata_item_0_value,modification_time,parameter_definition,queries_query_0_platform,queries_query_0_script,queries_query_0_script_type,queries_query_1_platform,queries_query_1_script,queries_query_1_script_type,queries_query_2_platform,queries_query_2_script,queries_query_2_script_type,source_id,string_count,subcolumns_subcolumn_0_hidden_flag,subcolumns_subcolumn_0_ignore_case_flag,subcolumns_subcolumn_0_index,subcolumns_subcolumn_0_name,subcolumns_subcolumn_0_value_type,subcolumns_subcolumn_1_hidden_flag,subcolumns_subcolumn_1_ignore_case_flag,subcolumns_subcolumn_1_index,subcolumns_subcolumn_1_name,subcolumns_subcolumn_1_value_type,subcolumns_subcolumn_2_hidden_flag,subcolumns_subcolumn_2_ignore_case_flag,subcolumns_subcolumn_2_index,subcolumns_subcolumn_2_name,subcolumns_subcolumn_2_value_type,subcolumns_subcolumn_3_hidden_flag,subcolumns_subcolumn_3_ignore_case_flag,subcolumns_subcolumn_3_index,subcolumns_subcolumn_3_name,subcolumns_subcolumn_3_value_type,subcolumns_subcolumn_4_hidden_flag,subcolumns_subcolumn_4_ignore_case_flag,subcolumns_subcolumn_4_index,subcolumns_subcolumn_4_name,subcolumns_subcolumn_4_value_type,subcolumns_subcolumn_5_hidden_flag,subcolumns_subcolumn_5_ignore_case_flag,subcolumns_subcolumn_5_index,subcolumns_subcolumn_5_name,subcolumns_subcolumn_5_value_type,value_type
Computer Name,&quot;The assigned name of the client machine.
Example: workstation-1.company.com&quot;,Reserved,,,0,3409330187,0,3,1,,86400,,,,,,Windows,select CSName from win32_operatingsystem,WMIQuery,,,,,,,0,7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,String
IP Route Details,&quot;Returns IPv4 network routes, filtered to exclude noise. With Flags, Metric, Interface columns.
Example:  172.16.0.0|192.168.1.1|255.255.0.0|UG|100|eth0&quot;,Network,2014-12-06T18:00:24,|,1,435227963,0,737,1,Jim Olsen,60,0,defined,Tanium,2014-12-06T18:00:24,,Windows,&quot;strComputer = &amp;quot;.&amp;quot;
Set objWMIService = GetObject(&amp;quot;winmgmts:&amp;quot; _
    &amp;amp; &amp;quot;{impersonationLevel=impersonate}!\\&amp;quot; &amp;amp; strComputer &amp;amp; &amp;quot;\root\cimv2&amp;quot;)

Set collip = objWMIService.ExecQuery(&amp;quot;select * from win32_networkadapterconfiguration where IPEnabled=&amp;#039;True&amp;#039;&amp;quot;)
dim ipaddrs()
ipcount = 0
for each ipItem in collip
    for each ipaddr in ipItem.IPAddress
        ipcount = ipcount + 1
    next
next
redim ipaddrs(ipcount)
ipcount = 0
for each ipItem in collip
    for each ipaddr in ipItem.IPAddress
        ipcount = ipcount + 1
        ipaddrs(ipcount) = ipaddr
    next
next
localhost = &amp;quot;127.0.0.1&amp;quot;

Set colItems = objWMIService.ExecQuery(&amp;quot;Select * from Win32_IP4RouteTable&amp;quot;)

For Each objItem in colItems
    dest = objItem.Destination
    gw = objItem.NextHop
    mask = objItem.Mask
    metric = objItem.Metric1
    flags = objItem.Type
    intf = objItem.InterfaceIndex
    For i = 0 to ipcount
        if gw = ipaddrs(i) and gw &amp;lt;&amp;gt; localhost then
            gw = &amp;quot;0.0.0.0&amp;quot;
        end if
    Next
    if gw &amp;lt;&amp;gt; localhost and dest &amp;lt;&amp;gt; &amp;quot;224.0.0.0&amp;quot; and right(dest,3) &amp;lt;&amp;gt; &amp;quot;255&amp;quot; then
        Wscript.Echo dest &amp;amp; &amp;quot;|&amp;quot; &amp;amp; gw &amp;amp; &amp;quot;|&amp;quot; &amp;amp; mask &amp;amp; &amp;quot;|&amp;quot; &amp;amp; &amp;quot;-&amp;quot; &amp;amp; &amp;quot;|&amp;quot; &amp;amp; metric &amp;amp; &amp;quot;|&amp;quot; &amp;amp; &amp;quot;-&amp;quot;
    end if
Next&quot;,VBScript,Linux,&quot;route -n | grep -v Kernel | grep -v Destination | awk &amp;#039;{ print $1 &amp;quot;|&amp;quot; $2 &amp;quot;|&amp;quot; $3 &amp;quot;|&amp;quot; $4 &amp;quot;|&amp;quot; $5 &amp;quot;|&amp;quot; $8 }&amp;#039; | grep -v &amp;quot;|127.0.0.1|&amp;quot;
&quot;,UnixShell,Mac,&quot;netstat -rn | grep -v &amp;quot;:&amp;quot; | grep -v Destination | grep -v Routing | grep -v -e &amp;quot;^$&amp;quot; | awk &amp;#039;{ print $1 &amp;quot;|&amp;quot; $2 &amp;quot;||&amp;quot; $3 &amp;quot;||&amp;quot; $6 }&amp;#039; | grep -v &amp;quot;|127.0.0.1|&amp;quot;
&quot;,UnixShell,0,48,0,1,0,Destination,IPAddress,0,1,1,Gateway,IPAddress,0,1,2,Mask,String,0,1,3,Flags,String,0,1,4,Metric,NumericInteger,0,1,5,Interface,String,String
IP Address,&quot;Current IP Addresses of client machine.
Example: 192.168.1.1&quot;,Network,2014-12-06T18:00:22,&quot;,&quot;,1,3209138996,0,147,1,Jim Olsen,600,0,defined,Tanium,2014-12-06T18:00:22,,Windows,select IPAddress from win32_networkadapterconfiguration where IPEnabled=&amp;#039;True&amp;#039;,WMIQuery,Linux,&quot;#!/bin/bash
ifconfig | grep -w inet | grep -v 127.0.0.1 | awk &amp;#039;{print $2}&amp;#039; | sed -e &amp;#039;s/addr://&amp;#039;
&quot;,UnixShell,Mac,&quot;#!/bin/bash

ifconfig -a -u |grep &amp;quot;inet&amp;quot; | grep -v &amp;quot;::1&amp;quot; | grep -v &amp;quot;127.0.0.1&amp;quot;| awk &amp;#039;{print $2}&amp;#039; | cut -f1 -d&amp;#039;%&amp;#039;
&quot;,UnixShell,0,86,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IPAddress
Folder Name Search with RegEx Match,&quot;Finds the specified folder and provides the full path if the folder exists on the client machine. Takes regular expression to match.
Example: C:\WINDOWS\System32&quot;,File System,2014-12-06T18:00:23,&quot;,&quot;,1,1374547302,0,381,1,Jim Olsen,600,0,defined,McAfee,2014-12-06T18:00:23,&quot;{&quot;&quot;parameters&quot;&quot;:[{&quot;&quot;restrict&quot;&quot;:null,&quot;&quot;validationExpressions&quot;&quot;:[{&quot;&quot;flags&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;expression&quot;&quot;:&quot;&quot;\\S{3}&quot;&quot;,&quot;&quot;helpString&quot;&quot;:&quot;&quot;Value must be at least 3 characters&quot;&quot;,&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.models::ValidationExpression&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.models::ValidationExpression&quot;&quot;}],&quot;&quot;helpString&quot;&quot;:&quot;&quot;Enter the folder name to search for&quot;&quot;,&quot;&quot;value&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;promptText&quot;&quot;:&quot;&quot;e.g Program Files&quot;&quot;,&quot;&quot;defaultValue&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;label&quot;&quot;:&quot;&quot;Search for Folder Name&quot;&quot;,&quot;&quot;maxChars&quot;&quot;:0,&quot;&quot;key&quot;&quot;:&quot;&quot;dirname&quot;&quot;,&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.components.parameters::TextInputParameter&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.components.parameters::TextInputParameter&quot;&quot;},{&quot;&quot;restrict&quot;&quot;:null,&quot;&quot;validationExpressions&quot;&quot;:[{&quot;&quot;flags&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;expression&quot;&quot;:&quot;&quot;\\S{3}&quot;&quot;,&quot;&quot;helpString&quot;&quot;:&quot;&quot;Value must be at least 3 characters&quot;&quot;,&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.models::ValidationExpression&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.models::ValidationExpression&quot;&quot;}],&quot;&quot;helpString&quot;&quot;:&quot;&quot;Enter the regular expression to search for.&quot;&quot;,&quot;&quot;value&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;promptText&quot;&quot;:&quot;&quot;e.g. test*.exe&quot;&quot;,&quot;&quot;defaultValue&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;label&quot;&quot;:&quot;&quot;Regular Expression&quot;&quot;,&quot;&quot;maxChars&quot;&quot;:0,&quot;&quot;key&quot;&quot;:&quot;&quot;regexp&quot;&quot;,&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.components.parameters::TextInputParameter&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.components.parameters::TextInputParameter&quot;&quot;},{&quot;&quot;helpString&quot;&quot;:&quot;&quot;Enter Yes/No for case sensitivity of search.&quot;&quot;,&quot;&quot;value&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;promptText&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;defaultValue&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;requireSelection&quot;&quot;:true,&quot;&quot;label&quot;&quot;:&quot;&quot;Case sensitive?&quot;&quot;,&quot;&quot;key&quot;&quot;:&quot;&quot;casesensitive&quot;&quot;,&quot;&quot;values&quot;&quot;:[&quot;&quot;No&quot;&quot;,&quot;&quot;Yes&quot;&quot;],&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.components.parameters::DropDownParameter&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.components.parameters::DropDownParameter&quot;&quot;},{&quot;&quot;helpString&quot;&quot;:&quot;&quot;Enter Yes/No whether the search is global.&quot;&quot;,&quot;&quot;value&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;promptText&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;defaultValue&quot;&quot;:&quot;&quot;&quot;&quot;,&quot;&quot;requireSelection&quot;&quot;:true,&quot;&quot;label&quot;&quot;:&quot;&quot;Global&quot;&quot;,&quot;&quot;key&quot;&quot;:&quot;&quot;global&quot;&quot;,&quot;&quot;values&quot;&quot;:[&quot;&quot;No&quot;&quot;,&quot;&quot;Yes&quot;&quot;],&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.components.parameters::DropDownParameter&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.components.parameters::DropDownParameter&quot;&quot;}],&quot;&quot;model&quot;&quot;:&quot;&quot;com.tanium.components.parameters::ParametersArray&quot;&quot;,&quot;&quot;parameterType&quot;&quot;:&quot;&quot;com.tanium.components.parameters::ParametersArray&quot;&quot;}&quot;,Windows,&quot;&amp;#039;========================================
&amp;#039; Folder Name Search with RegEx Match
&amp;#039;========================================
&amp;#039;@INCLUDE=utils/SensorRandomization/SensorRandomizationFunctions.vbs
Option Explicit

SensorRandomize()

Dim Pattern,strRegExp,strGlobalArg,strCaseSensitiveArg
Dim bGlobal,bCaseSensitive

Pattern = unescape(&amp;quot;||dirname||&amp;quot;)
strRegExp = Trim(Unescape(&amp;quot;||regexp||&amp;quot;))
strGlobalArg = Trim(Unescape(&amp;quot;||global||&amp;quot;))
strCaseSensitiveArg = Trim(Unescape(&amp;quot;||casesensitive||&amp;quot;))

bGlobal = GetTrueFalseArg(&amp;quot;global&amp;quot;,strGlobalArg)
bCaseSensitive = GetTrueFalseArg(&amp;quot;casesensitive&amp;quot;,strCaseSensitiveArg)

Const SYSTEM_FOLDER = 1, TEMP_FOLDER = 2, FOR_READING = 1

Dim FSO, WshShell, Drives, Drive, TextStream, OutputFilename, strLine

Set FSO = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
Set WshShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)

OutputFilename = TempName() &amp;#039; a temporary file in system&amp;#039;s temp dir

&amp;#039; Go through file system, refresh output file for filename
If Not FSO.FileExists(OutputFilename) Then

    If FSO.FileExists(OutputFilename) Then FSO.DeleteFile OutputFilename

    &amp;#039; Get the collection of local drives.
    Set Drives = FSO.Drives
    For Each Drive in Drives
            If Drive.DriveType = 2 Then &amp;#039; 2 = Fixed drive
                    &amp;#039; Run the Dir command that looks for the filename pattern.
                    RunCommand &amp;quot;dir &amp;quot; &amp;amp;Chr(34)&amp;amp; Drive.DriveLetter &amp;amp; &amp;quot;:\&amp;quot; &amp;amp; Pattern &amp;amp; Chr(34)&amp;amp;&amp;quot; /a:D /B /S&amp;quot;, OutputFilename, true
            End If
    Next
End If

&amp;#039; Open the output file, echo each line, and then close and delete it.
Set TextStream = FSO.OpenTextFile(OutputFileName, FOR_READING)
Do While Not TextStream.AtEndOfStream
    strLine = TextStream.ReadLine()
    If RegExpMatch(strRegExp,strLine,bGlobal,bCaseSensitive) Then
            WScript.Echo strLine
    End If
Loop


TextStream.Close()

If FSO.FileExists(OutputFileName) Then
    On Error Resume Next
    FSO.DeleteFile OutputFileName, True
    On Error Goto 0
End If

Function RegExpMatch(strPattern,strToMatch,bGlobal,bIsCaseSensitive)

    Dim re
    Set re = New RegExp
    With re
      .Pattern = strPattern
      .Global = bGlobal
      .IgnoreCase = Not bIsCaseSensitive
    End With

    RegExpMatch = re.Test(strToMatch)

End Function &amp;#039;RegExpMatch


Function GetTrueFalseArg(strArgName,strArgValue)
    &amp;#039; Checks for valid values, will fail with error message

    Dim bArgVal
    bArgVal = False
    Select Case LCase(strArgValue)
            Case &amp;quot;true&amp;quot;
                    bArgVal = True
            Case &amp;quot;yes&amp;quot;
                    bArgVal = True
            Case &amp;quot;false&amp;quot;
                    bArgVal = False
            Case &amp;quot;no&amp;quot;
                    bArgVal = False
            Case Else
                    WScript.Echo &amp;quot;Error: Argument &amp;#039;&amp;quot;&amp;amp;strArgName&amp;amp;&amp;quot;&amp;#039; must be True or False, quitting&amp;quot;
                    PrintUsage
    End Select
    GetTrueFalseArg = bArgVal

End Function &amp;#039;GetTrueFalseArg


&amp;#039; Returns the name of a temporary file in the Temp directory.
Function TempName()
    Dim Result
    Do
            Result = FSO.BuildPath(FSO.GetSpecialFolder(TEMP_FOLDER), FSO.GetTempName())
            WScript.Sleep 200 &amp;#039;avoid potential busy loop
    Loop While FSO.FileExists(Result)

    TempName = Result
End Function &amp;#039;TempName

&amp;#039; Runs a command with Cmd.exe and redirects its output to a temporary
&amp;#039; file. The function returns the name of the temporary file that holds
&amp;#039; the command&amp;#039;s output.
Function RunCommand(Command, OutputFilename, b64BitNecessary)
    &amp;#039; 64BitNecessary true when you need to examine the 64-bit areas like system32
    Dim CommandLine,WshShell,strPRogramFilesx86,strDOSCall,objFSO
    Set objFSO = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    Set WshShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)

    strDOSCall = &amp;quot;%ComSpec% /C &amp;quot;

    &amp;#039; if 64-bit OS *and* we must examine in 64-bit mode to avoid FS Redirection
    strProgramFilesx86=WshShell.ExpandEnvironmentStrings(&amp;quot;%ProgramFiles%&amp;quot;)
    If objFSO.FolderExists(strProgramFilesx86) And b64BitNecessary Then &amp;#039; quick check for x64
            strDOSCall = FixFileSystemRedirectionForPath(WshShell.ExpandEnvironmentStrings(strDOSCall))
    End If

    CommandLine = WshShell.ExpandEnvironmentStrings(strDOSCall &amp;amp; Command &amp;amp; &amp;quot; &amp;gt;&amp;gt; &amp;quot;&amp;quot;&amp;quot; &amp;amp; OutputFileName &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;quot;)
    WshShell.Run CommandLine, 0, True
End Function &amp;#039;RunCommand

Function FixFileSystemRedirectionForPath(strFilePath)
&amp;#039; This function will fix a folder location so that
&amp;#039; a 32-bit program can be passed the windows\system32 directory
&amp;#039; as a parameter.
&amp;#039; Even if the sensor or action runs in 64-bit mode, a 32-bit
&amp;#039; program called in a 64-bit environment cannot access
&amp;#039; the system32 directory - it would be redirected to syswow64.
&amp;#039; you would not want to do this for 64-bit programs.

    Dim objFSO, strSystem32Location,objShell
    Dim strProgramFilesx86,strNewSystem32Location,strRestOfPath
    Set objFSO = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    Set objShell = CreateObject(&amp;quot;Wscript.Shell&amp;quot;)

    strProgramFilesx86=objShell.ExpandEnvironmentStrings(&amp;quot;%ProgramFiles%&amp;quot;)

    strFilePath = LCase(strFilePath)
    strSystem32Location = LCase(objFSO.GetSpecialFolder(1))
    strProgramFilesx86=objShell.ExpandEnvironmentStrings(&amp;quot;%ProgramFiles(x86)%&amp;quot;)

    If objFSO.FolderExists(strProgramFilesx86) Then &amp;#039; quick check for x64
            If InStr(strFilePath,strSystem32Location) = 1 Then
                    strRestOfPath = Replace(strFilePath,strSystem32Location,&amp;quot;&amp;quot;)
                    strNewSystem32Location = Replace(strSystem32Location,&amp;quot;system32&amp;quot;,&amp;quot;sysnative&amp;quot;)
                    strFilePath = strNewSystem32Location&amp;amp;strRestOfPath
            End If
    End If
    FixFileSystemRedirectionForPath = strFilePath

    &amp;#039;Cleanup
    Set objFSO = Nothing
End Function &amp;#039;FixFileSystemRedirectionForPath
&amp;#039;------------ INCLUDES after this line. Do not edit past this point -----
&amp;#039;- Begin file: utils/SensorRandomization/SensorRandomizationFunctions.vbs
&amp;#039;&amp;#039; -- Begin Random Sleep Functions -- &amp;#039;&amp;#039;

Dim bSensorRandomizeDebugOutput : bSensorRandomizeDebugOutput = False

Function SensorRandomizeLow()
    Dim intSensorRandomizeWaitLow : intSensorRandomizeWaitLow = 10
    SensorRandomizeRandomSleep(intSensorRandomizeWaitLow)
End Function &amp;#039; SensorRandomizeLow

Function SensorRandomize()
    Dim intSensorRandomizeWaitMed : intSensorRandomizeWaitMed = 20
    SensorRandomizeRandomSleep(intSensorRandomizeWaitMed)
End Function &amp;#039; SensorRandomize

Function SensorRandomizeHigh()
    Dim intSensorRandomizeWaitHigh : intSensorRandomizeWaitHigh = 30
    SensorRandomizeRandomSleep(intSensorRandomizeWaitHigh)
End Function &amp;#039; SensorRandomize

Function SensorRandomizeRandomSleep(intSleepTime)
&amp;#039; sleeps for a random period of time, intSleepTime is in seconds
&amp;#039; if the sensor randomize flag is on
&amp;#039; RandomizeScalingFactor is a multiplier on the values hardcoded in the sensor
&amp;#039; not typically set but can adjust timings per endpoint, optionally
    Dim intSensorRandomizeWaitTime
    Dim objShell,intRandomizeFlag,strRandomizeRegPath,intRandomizeScalingPercentage
    strRandomizeRegPath = SensorRandomizeGetTaniumRegistryPath&amp;amp;&amp;quot;\Sensor Data\Random Sleep&amp;quot;

    Set objShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)
    On Error Resume Next
    intRandomizeFlag = objShell.RegRead(&amp;quot;HKLM\&amp;quot;&amp;amp;strRandomizeRegPath&amp;amp;&amp;quot;\SensorRandomizeFlag&amp;quot;)
    intRandomizeScalingPercentage = objShell.RegRead(&amp;quot;HKLM\&amp;quot;&amp;amp;strRandomizeRegPath&amp;amp;&amp;quot;\SensorRandomizeScalingPercentage&amp;quot;)
    On Error Goto 0
    If intRandomizeFlag &amp;gt; 0 Then
            If intRandomizeScalingPercentage &amp;gt; 0 Then
                    intSleepTime = intRandomizeScalingPercentage * .01 * intSleepTime
                    SensorRandomizeEcho &amp;quot;Randomize scaling percentage of &amp;quot; _
                            &amp;amp; intRandomizeScalingPercentage &amp;amp; &amp;quot; applied, new sleep time is &amp;quot; &amp;amp; intSleepTime
            End If
            intSensorRandomizeWaitTime = CLng(intSleepTime) * 1000 &amp;#039; convert to milliseconds
            &amp;#039; wait random interval between 0 and the max
            Randomize(SensorRandomizeTaniumRandomSeed)
            &amp;#039; assign random value to wait time max value
            intSensorRandomizeWaitTime = Int( ( intSensorRandomizeWaitTime + 1 ) * Rnd )
            SensorRandomizeEcho &amp;quot;Sleeping for &amp;quot; &amp;amp; intSensorRandomizeWaitTime &amp;amp; &amp;quot; milliseconds&amp;quot;
            WScript.Sleep(intSensorRandomizeWaitTime)
            SensorRandomizeEcho &amp;quot;Done sleeping, continuing ...&amp;quot;
    Else
            SensorRandomizeEcho &amp;quot;SensorRandomize Not Enabled - No Op&amp;quot;
    End If
End Function &amp;#039;SensorRandomizeRandomSleep

Function SensorRandomizeTaniumRandomSeed
&amp;#039; for randomizing sensor code, the default seed is not random enough
    Dim timerNum
    timerNum = Timer()
    If timerNum &amp;lt; 1 Then
            SensorRandomizeTaniumRandomSeed = (SensorRandomizeGetTaniumComputerID / Timer() * 10 )
    Else
            SensorRandomizeTaniumRandomSeed = SensorRandomizeGetTaniumComputerID / Timer
    End If
End Function &amp;#039;SensorRandomizeTaniumRandomSeed

Function SensorRandomizeGetTaniumRegistryPath
&amp;#039;SensorRandomizeGetTaniumRegistryPath works in x64 or x32
&amp;#039;looks for a valid Path value

    Dim objShell
    Dim keyNativePath, keyWoWPath, strPath, strFoundTaniumRegistryPath

    Set objShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)

    keyNativePath = &amp;quot;Software\Tanium\Tanium Client&amp;quot;
    keyWoWPath = &amp;quot;Software\Wow6432Node\Tanium\Tanium Client&amp;quot;

    &amp;#039; first check the Software key (valid for 32-bit machines, or 64-bit machines in 32-bit mode)
    On Error Resume Next
    strPath = objShell.RegRead(&amp;quot;HKLM\&amp;quot;&amp;amp;keyNativePath&amp;amp;&amp;quot;\Path&amp;quot;)
    On Error Goto 0
    strFoundTaniumRegistryPath = keyNativePath

    If strPath = &amp;quot;&amp;quot; Then
            &amp;#039; Could not find 32-bit mode path, checking Wow6432Node
            On Error Resume Next
            strPath = objShell.RegRead(&amp;quot;HKLM\&amp;quot;&amp;amp;keyWoWPath&amp;amp;&amp;quot;\Path&amp;quot;)
            On Error Goto 0
            strFoundTaniumRegistryPath = keyWoWPath
    End If

    If Not strPath = &amp;quot;&amp;quot; Then
            SensorRandomizeGetTaniumRegistryPath = strFoundTaniumRegistryPath
    Else
            SensorRandomizeGetTaniumRegistryPath = False
            WScript.Echo &amp;quot;Error: Cannot locate Tanium Registry Path&amp;quot;
    End If
End Function &amp;#039;SensorRandomizeGetTaniumRegistryPath

Function SensorRandomizeGetTaniumComputerID
&amp;#039;&amp;#039; This function gets the Tanium Computer ID
    Dim objShell
    Dim intClientID,strID,strKeyPath,strValueName

    strKeyPath = SensorRandomizeGetTaniumRegistryPath
    strValueName = &amp;quot;ComputerID&amp;quot;
    Set objShell = CreateObject(&amp;quot;WScript.Shell&amp;quot;)
    On Error Resume Next
    intClientID = objShell.RegRead(&amp;quot;HKLM\&amp;quot;&amp;amp;strKeyPath&amp;amp;&amp;quot;\&amp;quot;&amp;amp;strValueName)
    If Err.Number &amp;lt;&amp;gt; 0 Then
            SensorRandomizeGetTaniumComputerID = 0
    Else
            SensorRandomizeGetTaniumComputerID = SensorRandomizeReinterpretSignedAsUnsigned(intClientID)
    End If
    On Error Goto 0
End Function &amp;#039;SensorRandomizeGetTaniumComputerID

Function SensorRandomizeReinterpretSignedAsUnsigned(ByVal x)
      If x &amp;lt; 0 Then x = x + 2^32
      SensorRandomizeReinterpretSignedAsUnsigned = x
End Function &amp;#039;SensorRandomizeReinterpretSignedAsUnsigned

Sub SensorRandomizeEcho(str)
    If bSensorRandomizeDebugOutput = true Then WScript.Echo str
End Sub &amp;#039;SensorRandomizeEcho
&amp;#039; -- End Random Sleep Functions --&amp;#039;
&amp;#039;- End file: utils/SensorRandomization/SensorRandomizationFunctions.vbs&quot;,VBScript,Linux,&quot;#!/bin/bash
#||dirname||||regexp||||casesensitive||||global||
echo Windows Only
&quot;,UnixShell,Mac,&quot;#!/bin/bash
#||dirname||||regexp||||casesensitive||||global||
echo Windows Only
&quot;,UnixShell,0,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,String
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="export_basetype_json_default_options.html" class="btn btn-neutral float-right" title="6.1.11.13. Export basetype json default options">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="export_basetype_csv_with_sort_true.html" class="btn btn-neutral" title="6.1.11.11. Export basetype csv with sort true"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Tanium.
      Last updated on Dec 08, 2014.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>